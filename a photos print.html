<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Passport Photo Printer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        
        .container {
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        #photoGrid {
            margin-top: 20px;
            display: grid;
            gap: 10px;
            justify-content: center;
        }
        
        .photo {
            border: 1px solid #ddd;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        }
        
        .resizer {
            margin: 10px 0;
        }
        
        .resizer label {
            margin-right: 5px;
        }
        
        .resizer input, .resizer select {
            margin-right: 10px;
        }
        
        .image-container {
            margin-top: 20px;
        }
        
        .image-container img {
            max-width: 100px;
            border: 1px solid #ddd;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
            display: block;
            margin: 0 auto 10px;
        }
        
        .grid-options {
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Passport Photo Printer</h1>
        <input type="file" id="fileInput" accept="image/*" onchange="displayUploadedPhoto()">
        <div id="chosenImageContainer" class="image-container" style="display: none;">
            <img id="chosenImage" alt="Chosen Image">
            <button onclick="removeChosenImage()">Change Image</button>
        </div>
        <input type="number" id="copiesInput" placeholder="Number of copies" min="1" max="50">
        <div class="resizer">
            <label for="widthInput">Width:</label>
            <input type="number" id="widthInput" placeholder="Width" min="1">
            <select id="widthUnit">
                <option value="px">px</option>
                <option value="in">in</option>
            </select>
            <label for="heightInput">Height:</label>
            <input type="number" id="heightInput" placeholder="Height" min="1">
            <select id="heightUnit">
                <option value="px">px</option>
                <option value="in">in</option>
            </select>
        </div>
        <div class="grid-options">
            <label for="gridColumns">Grid Columns:</label>
            <select id="gridColumns">
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="6">6</option>
            </select>
        </div>
        <button onclick="generateGrid()">Generate</button>
        <button onclick="resizeGrid()">Resize</button>
        <button onclick="changeGridColumns()">Change Columns</button>
        <button onclick="downloadGrid()">Download</button>
        <button onclick="printGrid()">Print</button>
        <div id="photoGrid"></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>
    <script>
        let uploadedImageSrc = '';

        function displayUploadedPhoto() {
            const fileInput = document.getElementById('fileInput');
            const chosenImage = document.getElementById('chosenImage');
            const chosenImageContainer = document.getElementById('chosenImageContainer');
            const file = fileInput.files[0];
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    uploadedImageSrc = e.target.result;
                    chosenImage.src = uploadedImageSrc;
                    chosenImageContainer.style.display = 'block';
                    fileInput.style.display = 'none';
                };
                reader.readAsDataURL(file);
            }
        }

        function removeChosenImage() {
            const fileInput = document.getElementById('fileInput');
            const chosenImageContainer = document.getElementById('chosenImageContainer');
            
            fileInput.value = '';
            chosenImageContainer.style.display = 'none';
            fileInput.style.display = 'block';
        }

        function generateGrid() {
            const copiesInput = document.getElementById('copiesInput');
            const widthInput = document.getElementById('widthInput');
            const heightInput = document.getElementById('heightInput');
            const widthUnit = document.getElementById('widthUnit');
            const heightUnit = document.getElementById('heightUnit');
            const gridColumns = document.getElementById('gridColumns');
            const photoGrid = document.getElementById('photoGrid');
            const numCopies = parseInt(copiesInput.value, 10);
        
            if (!uploadedImageSrc) {
                alert('Please select a photo.');
                return;
            }
        
            if (isNaN(numCopies) || numCopies <= 0) {
                alert('Please enter a valid number of copies.');
                return;
            }
        
            const width = widthInput.value ? parseInt(widthInput.value, 10) : null;
            const height = heightInput.value ? parseInt(heightInput.value, 10) : null;
            const widthInPx = width && widthUnit.value === 'in' ? width * 96 : width; // 96 pixels per inch
            const heightInPx = height && heightUnit.value === 'in' ? height * 96 : height;
        
            const columns = parseInt(gridColumns.value, 10);
            photoGrid.style.gridTemplateColumns = `repeat(${columns}, auto)`;
            photoGrid.innerHTML = ''; // Clear the grid
        
            for (let i = 0; i < numCopies; i++) {
                const img = document.createElement('img');
                img.src = uploadedImageSrc;
                img.className = 'photo';
                if (widthInPx) img.style.width = `${widthInPx}px`;
                if (heightInPx) img.style.height = `${heightInPx}px`;
                photoGrid.appendChild(img);
            }
        }

        function resizeGrid() {
            const widthInput = document.getElementById('widthInput');
            const heightInput = document.getElementById('heightInput');
            const widthUnit = document.getElementById('widthUnit');
            const heightUnit = document.getElementById('heightUnit');
            const photoGrid = document.getElementById('photoGrid');
            
            const width = widthInput.value ? parseInt(widthInput.value, 10) : null;
            const height = heightInput.value ? parseInt(heightInput.value, 10) : null;
            const widthInPx = width && widthUnit.value === 'in' ? width * 96 : width; // 96 pixels per inch
            const heightInPx = height && heightUnit.value === 'in' ? height * 96 : height;

            const photos = photoGrid.getElementsByClassName('photo');
            for (let i = 0; i < photos.length; i++) {
                const img = photos[i];
                if (widthInPx) img.style.width = `${widthInPx}px`;
                if (heightInPx) img.style.height = `${heightInPx}px`;
            }
        }

        function changeGridColumns() {
            const gridColumns = document.getElementById('gridColumns');
            const photoGrid = document.getElementById('photoGrid');
            const columns = parseInt(gridColumns.value, 10);
            photoGrid.style.gridTemplateColumns = `repeat(${columns}, auto)`;
        }

        function downloadGrid() {
            const photoGrid = document.getElementById('photoGrid');
            html2canvas(photoGrid).then(canvas => {
                const link = document.createElement('a');
                link.download = 'photo_grid.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        function printGrid() {
            const photoGrid = document.getElementById('photoGrid');
            const originalContents = document.body.innerHTML;
            const printContents = photoGrid.outerHTML;

            document.body.innerHTML = printContents;
            window.print();
            document.body.innerHTML = originalContents;
            window.location.reload();
        }
    </script>
</body>
</html>
